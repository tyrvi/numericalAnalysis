function J = doubgauss(f, a, b, c, d, m, n)

    if (max(m,n) > 5)
        error('Last two arguments may be at most 5.');
    else
        R = zeros(5, 5);
        R(2,1) = .5773502692;
        R(2,2) = -.5773502692;
        R(3,1) = .7745966692;
        R(3,3) = -.7745966692;
        R(4,1) = .8611363116;
        R(4,2) = .3399810436;
        R(4,3) = -.3399810436;
        R(4,4) = -.8611363116;
        R(5,1) = .9061798459;
        R(5,2) = .5384693101;
        R(5,4) = -.5384693101;
        R(5,5) = -.9061798459;

        C = zeros(5, 5);
        C(2,1) = 1;
        C(2,2) = 1;
        C(3,1) = .5555555556;
        C(3,2) = .8888888889;
        C(3,3) = .5555555556;
        C(4,1) = .3478548451;
        C(4,2) = .6521451549;
        C(4,3) = .6521451549;
        C(4,4) = .3478548451;
        C(5,1) = .2369268850;
        C(5,2) = .4786286705;
        C(5,3) = .5688888889;         
        C(5,4) = .4786286705;
        C(5,5) = .2369268850;

        h1 = (b-a) / 2;
        h2 = (b+a) / 2;
        J = 0;

        for i = 1:m
            JX = 0;
            x = h1*R(m, i) + h2;
            c1 = c(x);
            d1 = d(x);
            k1 = (d1-c1) / 2;
            k2 = (d1+c1) / 2;
            for j = 1:n
                y = k1*R(n,j) + k2;
                JX = JX + C(n, j)*f(x, y);
            end
            J = J + C(m, i)*k1*JX;
        end
        J = h1*J;
end
